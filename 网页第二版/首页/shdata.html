<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>数据集审核管理</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f8fafc;
            color: #334155;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .controls {
            background: white;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid #e2e8f0;
        }

        .controls-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 200px;
        }

        .filter-group label {
            font-weight: 600;
            color: #374151;
            font-size: 14px;
        }

        select, input {
            padding: 10px 14px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s;
            background: white;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .batch-actions {
            display: flex;
            gap: 12px;
            align-items: center;
            margin-left: auto;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-danger {
            background: #ef4444;
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-warning {
            background: #f59e0b;
            color: white;
        }

        .btn-warning:hover {
            background: #d97706;
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid #e2e8f0;
            overflow: hidden;
            margin-bottom: 24px;
        }

        .table-header {
            padding: 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .table-header h2 {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            margin: 0;
        }

        .table-filters {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-input, .table-filter {
            padding: 8px 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            min-width: 150px;
        }

        .search-input:focus, .table-filter:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .datasets-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .datasets-table th {
            background: #f8fafc;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e2e8f0;
            white-space: nowrap;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .datasets-table th.sortable {
            cursor: pointer;
            user-select: none;
            position: relative;
        }

        .datasets-table th.sortable:hover {
            background: #e2e8f0;
        }

        .datasets-table th.sortable::after {
            content: '↕';
            position: absolute;
            right: 4px;
            opacity: 0.5;
            font-size: 12px;
        }

        .datasets-table th.sortable.asc::after {
            content: '↑';
            opacity: 1;
        }

        .datasets-table th.sortable.desc::after {
            content: '↓';
            opacity: 1;
        }

        .datasets-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #e2e8f0;
            vertical-align: top;
            max-width: 200px;
        }

        .datasets-table tbody tr:hover {
            background: #f8fafc;
        }

        .datasets-table tbody tr.selected {
            background: rgba(102, 126, 234, 0.1);
        }

        .table-title {
            font-weight: 600;
            color: #1f2937;
            line-height: 1.4;
            max-width: 300px;
        }

        .table-description {
            max-width: 250px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            line-height: 1.4;
            color: #6b7280;
        }

        .table-link {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }

        .table-link:hover {
            text-decoration: underline;
        }

        .table-status {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            white-space: nowrap;
        }

        .table-actions {
            display: flex;
            gap: 4px;
            flex-wrap: wrap;
        }

        .table-btn {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
        }

        .metadata-info, .code-info {
            font-size: 12px;
            color: #6b7280;
            line-height: 1.3;
        }

        .has-metadata, .has-code {
            color: #10b981;
            font-weight: 600;
        }

        .missing-metadata, .missing-code {
            color: #ef4444;
            font-weight: 600;
        }

        .dataset-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
            position: relative;
        }

        .dataset-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
        }

        .dataset-card.selected {
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .dataset-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .dataset-title {
            font-size: 20px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
            flex: 1;
        }

        .dataset-checkbox {
            width: 20px;
            height: 20px;
            accent-color: #667eea;
            margin-right: 12px;
        }

        .dataset-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin-bottom: 20px;
        }

        .meta-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .meta-label {
            font-size: 12px;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .meta-value {
            color: #1f2937;
            font-weight: 500;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: inline-block;
        }

        .status-pending {
            background: #fef3c7;
            color: #92400e;
        }

        .status-approved {
            background: #d1fae5;
            color: #065f46;
        }

        .status-rejected {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-revision {
            background: #fce7f3;
            color: #9d174d;
        }

        .dataset-description {
            background: #f8fafc;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            color: #4b5563;
            line-height: 1.6;
        }

        .dataset-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e5e7eb;
        }

        .review-history {
            background: #f1f5f9;
            border-radius: 8px;
            padding: 16px;
            margin-top: 16px;
        }

        .review-history h4 {
            margin-bottom: 12px;
            color: #1f2937;
            font-size: 14px;
            font-weight: 600;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e2e8f0;
            font-size: 13px;
        }

        .history-item:last-child {
            border-bottom: none;
        }

        .history-action {
            font-weight: 600;
        }

        .history-date {
            color: #6b7280;
        }

        .feedback-section {
            margin-top: 16px;
            padding: 16px;
            background: #fef9e7;
            border-radius: 8px;
            border-left: 4px solid #f59e0b;
        }

        .feedback-section h4 {
            margin-bottom: 8px;
            color: #92400e;
            font-size: 14px;
        }

        .feedback-text {
            color: #78350f;
            font-size: 14px;
            line-height: 1.5;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            backdrop-filter: blur(4px);
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 32px;
            border-radius: 16px;
            box-shadow: 0 20px 64px rgba(0,0,0,0.2);
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal h3 {
            margin-bottom: 20px;
            color: #1f2937;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
            margin-top: 24px;
        }

        .stats-bar {
            display: flex;
            gap: 24px;
            margin-bottom: 24px;
        }

        .stat-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
            border: 1px solid #e2e8f0;
            flex: 1;
            text-align: center;
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 14px;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .controls-row {
                flex-direction: column;
                align-items: stretch;
            }

            .batch-actions {
                margin-left: 0;
                margin-top: 16px;
            }

            .dataset-meta {
                grid-template-columns: 1fr;
            }

            .dataset-actions {
                flex-direction: column;
                align-items: stretch;
            }

            .stats-bar {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 页面头部 -->
        <div class="header">
            <h1>数据集审核管理</h1>
            <p>管理和审核待发布的数据集，确保数据质量和合规性</p>
        </div>

        <!-- 统计信息 -->
        <div class="stats-bar">
            <div class="stat-item">
                <div class="stat-number" id="total-count">0</div>
                <div class="stat-label">总待审核</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="pending-count">0</div>
                <div class="stat-label">审核历史记录</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="revision-count">0</div>
                <div class="stat-label">待修改</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="today-count">0</div>
                <div class="stat-label">今日提交</div>
            </div>
        </div>

        <!-- 筛选和控制区域 -->
        <div class="controls">
            <div class="controls-row">
                <div class="filter-group">
                    <label for="status-filter">审核状态</label>
                    <select id="status-filter">
                        <option value="">全部状态</option>
                        <option value="pending">待审核</option>
                        <option value="revision">待修改</option>
                        <option value="approved">已通过</option>
                        <option value="rejected">已拒绝</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="species-filter">物种类型</label>
                    <select id="species-filter">
                        <option value="">全部物种</option>
                        <option value="human">人类</option>
                        <option value="mouse">小鼠</option>
                        <option value="rat">大鼠</option>
                        <option value="other">其他</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="platform-filter">测序平台</label>
                    <select id="platform-filter">
                        <option value="">全部平台</option>
                        <option value="10x">10x Genomics</option>
                        <option value="illumina">Illumina</option>
                        <option value="nanopore">Oxford Nanopore</option>
                        <option value="other">其他</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sort-by">排序方式</label>
                    <select id="sort-by">
                        <option value="submit_time">提交时间</option>
                        <option value="sample_count">样本数量</option>
                        <option value="cell_count">细胞数量</option>
                        <option value="author">作者名称</option>
                    </select>
                </div>
                <div class="batch-actions">
                    <button class="btn btn-success" onclick="batchAction('approve')" id="batch-approve" disabled>
                        批量通过
                    </button>
                    <button class="btn btn-danger" onclick="batchAction('reject')" id="batch-reject" disabled>
                        批量拒绝
                    </button>
                    <button class="btn btn-warning" onclick="batchAction('revision')" id="batch-revision" disabled>
                        批量要求修改
                    </button>
                </div>
            </div>
        </div>

        <!-- 数据集浓缩表格 -->
        <div class="table-container">
            <div class="table-header">
                <h2>待审核数据集概览表</h2>
                <div class="table-filters">
                    <input type="text" id="search-input" placeholder="搜索标题、作者、期刊..." class="search-input">
                    <select id="table-status-filter" class="table-filter">
                        <option value="">所有状态</option>
                        <option value="pending">待审核</option>
                        <option value="revision">待修改</option>
                        <option value="approved">已通过</option>
                        <option value="rejected">已拒绝</option>
                    </select>
                    <select id="table-species-filter" class="table-filter">
                        <option value="">所有物种</option>
                        <option value="human">人类</option>
                        <option value="mouse">小鼠</option>
                        <option value="rat">大鼠</option>
                        <option value="other">其他</option>
                    </select>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="datasets-table" class="datasets-table">
                    <thead>
                        <tr>
                            <th><input type="checkbox" id="select-all"></th>
                            <th class="sortable" data-column="title">数据集标题</th>
                            <th class="sortable" data-column="author">作者</th>
                            <th class="sortable" data-column="year">年份</th>
                            <th class="sortable" data-column="journal">期刊/DOI</th>
                            <th class="sortable" data-column="species">物种</th>
                            <th class="sortable" data-column="platform">平台</th>
                            <th class="sortable" data-column="samples">样本数</th>
                            <th class="sortable" data-column="cells">细胞数</th>
                            <th>文献链接</th>
                            <th>数据集描述</th>
                            <th>元数据概览</th>
                            <th>复现代码</th>
                            <th class="sortable" data-column="submitTime">提交时间</th>
                            <th class="sortable" data-column="submitter">提交人</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="table-body">
                        <!-- 表格内容将通过JavaScript生成 -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 审核反馈模态框 -->
    <div id="feedback-modal" class="modal">
        <div class="modal-content">
            <h3 id="modal-title">审核反馈</h3>
            <div class="form-group">
                <label for="feedback-text">反馈内容</label>
                <textarea id="feedback-text" placeholder="请输入您的审核意见和建议..."></textarea>
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeModal()">取消</button>
                <button class="btn btn-primary" onclick="submitFeedback()" id="submit-feedback">提交</button>
            </div>
        </div>
    </div>

    <script>
        // 模拟数据集数据
        let datasets = [
            {
                id: 1,
                title: "单细胞RNA测序揭示阿尔茨海默病大脑皮层细胞异质性",
                author: "张医生",
                year: 2024,
                journal: "Nature Neuroscience",
                doi: "10.1038/s41593-2024-12345",
                species: "human",
                platform: "10x Genomics",
                samples: 156,
                cells: 847293,
                status: "pending",
                description: "本研究通过单细胞RNA测序技术，深入分析了阿尔茨海默病患者和健康对照组的大脑皮层组织，发现了疾病特异性的细胞亚型和基因表达模式。数据集包含完整的原始数据、处理后的表达矩阵以及详细的细胞注释信息。",
                submitTime: "2024-12-15T10:30:00",
                submitter: "张医生实验室",
                literature_link: "https://doi.org/10.1038/s41593-2024-12345",
                reproduced: true,
                hasMetadata: true,
                hasCode: true,
                metadataOverview: "包含细胞类型注释、样本信息、实验条件等完整元数据",
                codeDescription: "提供完整的R分析脚本，包含数据预处理、降维、聚类和差异表达分析",
                envDescription: "R 4.3.0, Seurat 5.0, Docker环境配置文件",
                history: [
                    {action: "提交审核", date: "2024-12-15", reviewer: "系统"}
                ],
                feedback: null
            },
            {
                id: 2,
                title: "COVID-19患者肺泡灌洗液单细胞转录组分析",
                author: "李教授",
                year: 2024,
                journal: "Cell",
                doi: "10.1016/j.cell.2024.54321",
                species: "human",
                platform: "Illumina NovaSeq",
                samples: 89,
                cells: 523847,
                status: "revision",
                description: "通过对COVID-19重症患者肺泡灌洗液进行单细胞RNA测序，鉴定了病毒感染对肺部免疫细胞的影响。研究发现了多个与疾病严重程度相关的细胞标志物。",
                submitTime: "2024-12-10T14:20:00",
                submitter: "李教授课题组",
                literature_link: "https://doi.org/10.1016/j.cell.2024.54321",
                reproduced: false,
                hasMetadata: false,
                hasCode: true,
                metadataOverview: "缺少完整的样本临床信息和细胞类型注释标准",
                codeDescription: "提供Python分析代码，基于scanpy包进行分析",
                envDescription: "Python 3.9, scanpy 1.9.3, conda环境文件",
                history: [
                    {action: "提交审核", date: "2024-12-10", reviewer: "系统"},
                    {action: "要求修改", date: "2024-12-12", reviewer: "王审核员"}
                ],
                feedback: "请补充细胞类型注释的详细方法学描述，并提供质控参数的具体阈值。代码中缺少关键的预处理步骤说明。"
            },
            {
                id: 3,
                title: "小鼠胚胎发育过程中造血干细胞的单细胞图谱",
                author: "陈研究员",
                year: 2024,
                journal: "Science",
                doi: "10.1126/science.2024.67890",
                species: "mouse",
                platform: "10x Genomics",
                samples: 234,
                cells: 1247593,
                status: "pending",
                description: "系统性分析了小鼠胚胎发育过程中造血干细胞的分化轨迹和基因调控网络。数据涵盖胚胎发育的关键时期，为造血系统发育研究提供了重要资源。",
                submitTime: "2024-12-14T09:15:00",
                submitter: "陈研究员团队",
                literature_link: "https://doi.org/10.1126/science.2024.67890",
                reproduced: true,
                hasMetadata: true,
                hasCode: true,
                metadataOverview: "详细的发育时期标注、细胞谱系信息和实验批次记录",
                codeDescription: "完整的分析流程，包含轨迹推断和调控网络分析代码",
                envDescription: "R 4.2.0, monocle3, CellChat, Docker镜像",
                history: [
                    {action: "提交审核", date: "2024-12-14", reviewer: "系统"}
                ],
                feedback: null
            },
            {
                id: 4,
                title: "肝癌组织单细胞多组学联合分析",
                author: "王主任",
                year: 2024,
                journal: "Nature Medicine",
                doi: "10.1038/s41591-2024-11111",
                species: "human",
                platform: "10x Genomics",
                samples: 78,
                cells: 456789,
                status: "approved",
                description: "结合单细胞RNA和ATAC测序技术，全面解析肝癌组织的细胞组成和染色质可及性模式，为肝癌精准治疗提供新的靶点。",
                submitTime: "2024-12-08T16:45:00",
                submitter: "王主任医学团队",
                literature_link: "https://doi.org/10.1038/s41591-2024-11111",
                reproduced: true,
                hasMetadata: true,
                hasCode: true,
                metadataOverview: "包含多组学数据整合注释和临床相关信息",
                codeDescription: "多组学数据整合分析pipeline，包含ArchR和Seurat联合分析",
                envDescription: "R 4.3.0, ArchR 1.0.2, Seurat 5.0, Signac 1.12.0",
                history: [
                    {action: "提交审核", date: "2024-12-08", reviewer: "系统"},
                    {action: "审核通过", date: "2024-12-09", reviewer: "审核专家组"}
                ],
                feedback: null
            },
            {
                id: 5,
                title: "大鼠脑损伤模型神经细胞反应机制研究",
                author: "刘博士",
                year: 2024,
                journal: "Cell Reports",
                doi: "10.1016/j.celrep.2024.22222",
                species: "rat",
                platform: "Oxford Nanopore",
                samples: 45,
                cells: 234567,
                status: "rejected",
                description: "利用长读长测序技术研究大鼠脑损伤后神经细胞的分子反应和修复机制，发现了多个新的治疗靶点。",
                submitTime: "2024-12-05T11:20:00",
                submitter: "刘博士神经科学实验室",
                literature_link: "https://doi.org/10.1016/j.celrep.2024.22222",
                reproduced: false,
                hasMetadata: false,
                hasCode: false,
                metadataOverview: "元数据不完整，缺少实验设计和样本处理详情",
                codeDescription: "未提供分析代码",
                envDescription: "未提供环境配置信息",
                history: [
                    {action: "提交审核", date: "2024-12-05", reviewer: "系统"},
                    {action: "审核拒绝", date: "2024-12-07", reviewer: "质控专员"}
                ],
                feedback: "数据质量不符合标准，元数据严重缺失，未提供复现代码，建议重新整理后再次提交。"
            },
            {
                id: 6,
                title: "心肌梗死后心脏修复过程的单细胞时序分析",
                author: "赵教授",
                year: 2024,
                journal: "Circulation",
                doi: "10.1161/CIRCULATIONAHA.2024.33333",
                species: "mouse",
                platform: "10x Genomics",
                samples: 167,
                cells: 889456,
                status: "pending",
                description: "通过单细胞RNA测序技术追踪小鼠心肌梗死后不同时间点的细胞变化，揭示心脏修复和重塑的分子机制。",
                submitTime: "2024-12-16T08:30:00",
                submitter: "赵教授心血管研究中心",
                literature_link: "https://doi.org/10.1161/CIRCULATIONAHA.2024.33333",
                reproduced: true,
                hasMetadata: true,
                hasCode: true,
                metadataOverview: "时序实验设计完整，包含详细的样本采集时间点和处理方法",
                codeDescription: "基于R和Python的时序分析代码，包含轨迹推断和功能富集分析",
                envDescription: "R 4.3.0, Python 3.10, monocle3, scVelo, Docker配置",
                history: [
                    {action: "提交审核", date: "2024-12-16", reviewer: "系统"}
                ],
                feedback: null
            }
        ];

        let selectedDatasets = new Set();
        let currentAction = null;
        let currentDatasetId = null;

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            renderDatasets();
            updateStats();
            bindEvents();
        });

        // 绑定事件
        function bindEvents() {
            document.getElementById('status-filter').addEventListener('change', filterDatasets);
            document.getElementById('species-filter').addEventListener('change', filterDatasets);
            document.getElementById('platform-filter').addEventListener('change', filterDatasets);
            document.getElementById('sort-by').addEventListener('change', sortDatasets);
        }

        // 渲染数据集列表
        function renderDatasets(filteredDatasets = null) {
            const container = document.getElementById('dataset-list');
            const datasetsToRender = filteredDatasets || datasets;
            
            container.innerHTML = '';
            
            datasetsToRender.forEach(dataset => {
                const card = createDatasetCard(dataset);
                container.appendChild(card);
            });
            
            updateBatchActionButtons();
        }

        // 创建数据集卡片
        function createDatasetCard(dataset) {
            const card = document.createElement('div');
            card.className = 'dataset-card';
            card.innerHTML = `
                <div class="dataset-header">
                    <input type="checkbox" class="dataset-checkbox" data-id="${dataset.id}" 
                           onchange="toggleDatasetSelection(${dataset.id})">
                    <div style="flex: 1;">
                        <div class="dataset-title">${dataset.title}</div>
                        <span class="status-badge status-${dataset.status}">
                            ${getStatusText(dataset.status)}
                        </span>
                    </div>
                </div>
                
                <div class="dataset-meta">
                    <div class="meta-item">
                        <div class="meta-label">作者</div>
                        <div class="meta-value">${dataset.author}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">年份</div>
                        <div class="meta-value">${dataset.year}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">期刊</div>
                        <div class="meta-value">${dataset.journal}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">DOI</div>
                        <div class="meta-value">
                            <a href="${dataset.literature_link}" target="_blank" style="color: #667eea; text-decoration: none;">
                                ${dataset.doi}
                            </a>
                        </div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">物种</div>
                        <div class="meta-value">${getSpeciesText(dataset.species)}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">平台</div>
                        <div class="meta-value">${dataset.platform}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">样本数</div>
                        <div class="meta-value">${dataset.samples.toLocaleString()}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">细胞数</div>
                        <div class="meta-value">${dataset.cells.toLocaleString()}</div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">复现状态</div>
                        <div class="meta-value">
                            ${dataset.reproduced ? 
                                '<span style="color: #10b981;">✓ 已复现</span>' : 
                                '<span style="color: #ef4444;">✗ 待复现</span>'
                            }
                        </div>
                    </div>
                    <div class="meta-item">
                        <div class="meta-label">提交时间</div>
                        <div class="meta-value">${formatDate(dataset.submitTime)}</div>
                    </div>
                </div>
                
                <div class="dataset-description">
                    ${dataset.description}
                </div>
                
                ${dataset.feedback ? `
                    <div class="feedback-section">
                        <h4>审核反馈</h4>
                        <div class="feedback-text">${dataset.feedback}</div>
                    </div>
                ` : ''}
                
                <div class="review-history">
                    <h4>审核历史</h4>
                    ${dataset.history.map(item => `
                        <div class="history-item">
                            <span class="history-action">${item.action} - ${item.reviewer}</span>
                            <span class="history-date">${item.date}</span>
                        </div>
                    `).join('')}
                </div>
                
                <div class="dataset-actions">
                    <button class="btn btn-success" onclick="reviewDataset(${dataset.id}, 'approve')">
                        通过审核
                    </button>
                    <button class="btn btn-danger" onclick="reviewDataset(${dataset.id}, 'reject')">
                        不通过审核
                    </button>
                    <button class="btn btn-warning" onclick="reviewDataset(${dataset.id}, 'revision')">
                        要求修改
                    </button>
                    <button class="btn btn-secondary" onclick="viewDetails(${dataset.id})">
                        查看详情
                    </button>
                </div>
            `;
            
            return card;
        }

        // 状态文本映射
        function getStatusText(status) {
            const statusMap = {
                'pending': '待审核',
                'approved': '已通过',
                'rejected': '已拒绝',
                'revision': '待修改'
            };
            return statusMap[status] || status;
        }

        // 物种文本映射
        function getSpeciesText(species) {
            const speciesMap = {
                'human': '人类',
                'mouse': '小鼠',
                'rat': '大鼠',
                'other': '其他'
            };
            return speciesMap[species] || species;
        }

        // 格式化日期
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('zh-CN') + ' ' + date.toLocaleTimeString('zh-CN', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        // 切换数据集选择状态
        function toggleDatasetSelection(id) {
            const checkbox = document.querySelector(`input[data-id="${id}"]`);
            const card = checkbox.closest('.dataset-card');
            
            if (checkbox.checked) {
                selectedDatasets.add(id);
                card.classList.add('selected');
            } else {
                selectedDatasets.delete(id);
                card.classList.remove('selected');
            }
            
            updateBatchActionButtons();
        }

        // 更新批量操作按钮状态
        function updateBatchActionButtons() {
            const hasSelection = selectedDatasets.size > 0;
            document.getElementById('batch-approve').disabled = !hasSelection;
            document.getElementById('batch-reject').disabled = !hasSelection;
            document.getElementById('batch-revision').disabled = !hasSelection;
        }

        // 单个数据集审核
        function reviewDataset(id, action) {
            currentDatasetId = id;
            currentAction = action;
            
            if (action === 'approve') {
                if (confirm('确定要通过此数据集的审核吗？')) {
                    updateDatasetStatus(id, 'approved', '审核通过');
                }
            } else {
                openFeedbackModal(action);
            }
        }

        // 批量操作
        function batchAction(action) {
            if (selectedDatasets.size === 0) return;
            
            currentAction = action;
            const count = selectedDatasets.size;
            
            if (action === 'approve') {
                if (confirm(`确定要批量通过 ${count} 个数据集的审核吗？`)) {
                    selectedDatasets.forEach(id => {
                        updateDatasetStatus(id, 'approved', '批量审核通过');
                    });
                    clearSelection();
                }
            } else {
                openFeedbackModal(action);
            }
        }

        // 打开反馈模态框
        function openFeedbackModal(action) {
            const modal = document.getElementById('feedback-modal');
            const title = document.getElementById('modal-title');
            const textarea = document.getElementById('feedback-text');
            
            const titles = {
                'reject': '拒绝审核 - 请提供拒绝原因',
                'revision': '要求修改 - 请提供修改建议'
            };
            
            title.textContent = titles[action];
            textarea.value = '';
            modal.style.display = 'block';
        }

        // 关闭模态框
        function closeModal() {
            document.getElementById('feedback-modal').style.display = 'none';
            currentDatasetId = null;
            currentAction = null;
        }

        // 提交反馈
        function submitFeedback() {
            const